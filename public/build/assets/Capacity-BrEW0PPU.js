import{r as i,j as e,a as h}from"./app-Bzd2Cgmj.js";import{C as d}from"./Card-cqcK0fx-.js";import{T as p}from"./Table-Ds_uRqhm.js";import{B as u}from"./Badge-CgfdLi4n.js";import{B as f}from"./ChartCard-278V5e8g.js";/* empty css            */function N(){const[t,o]=i.useState([]),[n,r]=i.useState(!0),[c,m]=i.useState(null);i.useEffect(()=>{let s=!0;async function a(){try{r(!0);const l=await h("/capacity/schedule?range=7d");if(!s)return;o(l.data??[])}catch(l){if(!s)return;m(l instanceof Error?l.message:"Failed to load schedule")}finally{s&&r(!1)}}return a(),()=>{s=!1}},[]);const x=i.useMemo(()=>t.slice(0,6).map(s=>({cls:s.class_type,fill:s.fill_percent})),[t]);return e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[e.jsx(f,{data:x,title:"Class fill %",xKey:"cls",yKey:"fill"}),e.jsxs(d,{title:"Waitlist & no‑shows",subtitle:"Predicted vs actual",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"glass p-4",children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Avg waitlist"}),e.jsx("div",{className:"text-3xl font-semibold mt-1",children:t.length?(t.reduce((s,a)=>s+a.waitlist,0)/t.length).toFixed(1):"0.0"})]}),e.jsxs("div",{className:"glass p-4",children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Avg no‑show risk"}),e.jsx("div",{className:"text-3xl font-semibold mt-1",children:t.length?`${(t.reduce((s,a)=>s+a.predicted_no_show_percent,0)/t.length).toFixed(1)}%`:"0%"})]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-3",children:"Auto‑backfill is available for sessions with waitlists."})]})]}),e.jsxs(d,{title:"Upcoming schedule",subtitle:"Live fill & waitlist",children:[c&&e.jsx("div",{className:"text-sm text-red-600 mb-3",children:c}),e.jsx(p,{cols:[{key:"class_type",header:"Class"},{key:"starts_at",header:"Start"},{key:"capacity",header:"Cap"},{key:"booked",header:"Booked"},{key:"waitlist",header:"Waitlist"},{key:"fill_percent",header:"Fill %"},{key:"deposit_amount_cents",header:"Deposit",render:(s,a)=>a.deposit_required?e.jsxs(u,{tone:"warn",children:["$",(a.deposit_amount_cents/100).toFixed(0)]}):e.jsx("span",{className:"text-slate-400",children:"—"})}],rows:t.map(s=>({...s,starts_at:new Date(s.starts_at).toLocaleString()})),loading:n})]})]})}export{N as default};
