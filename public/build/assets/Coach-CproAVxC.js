import{r as a,j as t}from"./app-C2cRDrk6.js";import{C as m,T as B,a as l}from"./client-C_H5CMFT.js";import{B as u}from"./Badge-CbVuks5E.js";import{B as S}from"./Button-Dyjvqw8_.js";/* empty css            */function H(){const[v,N]=a.useState([]),[C,k]=a.useState(""),[o,h]=a.useState(null),[g,_]=a.useState("We opened a spot for tonight—want it?"),[r,c]=a.useState([]),[p,w]=a.useState("Logged RPE 7/10"),[x,y]=a.useState(""),[b,E]=a.useState("outcome"),[O,d]=a.useState(!0),[f,n]=a.useState(null);a.useEffect(()=>{async function e(){try{const[s,i]=await Promise.all([l("/admin/class-types"),l("/coach/roster")]);N(s.data??[]),h(i.data)}catch(s){n(s instanceof Error?s.message:"Failed to load coach console")}finally{d(!1)}}e()},[]);async function R(e){k(e),d(!0);try{const s=await l(e?`/coach/roster?class_type=${e}`:"/coach/roster");h(s.data),c([])}catch(s){n(s instanceof Error?s.message:"Failed to load roster")}finally{d(!1)}}async function T(){if(r.length!==0)try{await l("/coach/nudges",{method:"POST",body:JSON.stringify({member_ids:r,channel:"sms",body:g})}),c([])}catch(e){n(e instanceof Error?e.message:"Failed to send nudge")}}return t.jsxs("div",{className:"grid gap-6",children:[t.jsxs(m,{title:"Roster heatmap",subtitle:"Sort by program/class",children:[t.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[t.jsxs("select",{className:"border rounded-lg px-3 py-2",value:C,onChange:e=>R(e.target.value),children:[t.jsx("option",{value:"",children:"All classes"}),v.map(e=>t.jsx("option",{value:e.name,children:e.name},e.id))]}),t.jsx("div",{className:"flex gap-2 text-sm text-slate-500",children:Object.entries((o==null?void 0:o.heatmap)??{}).map(([e,s])=>t.jsxs("span",{children:[e,": ",s]},e))})]}),t.jsx(B,{cols:[{key:"select",header:"",render:(e,s)=>t.jsx("input",{type:"checkbox",checked:r.includes(s.member_id),onChange:i=>c(j=>i.target.checked?[...j,s.member_id]:j.filter(L=>L!==s.member_id))})},{key:"name",header:"Member"},{key:"class_type",header:"Class"},{key:"risk_band",header:"Risk",render:e=>e==="High"?t.jsx(u,{tone:"bad",children:"High"}):e==="Med"?t.jsx(u,{tone:"warn",children:"Med"}):t.jsx(u,{tone:"good",children:"Low"})},{key:"starts_at",header:"Next session"}],rows:((o==null?void 0:o.members)??[]).map(e=>({...e,starts_at:e.starts_at?new Date(e.starts_at).toLocaleString():"—"})),loading:O})]}),t.jsx(m,{title:"Quick nudge",subtitle:"Send a personal note",children:t.jsxs("div",{className:"grid gap-3",children:[t.jsx("textarea",{className:"border rounded-lg px-3 py-2",rows:3,value:g,onChange:e=>_(e.target.value)}),t.jsxs("div",{className:"flex justify-between items-center text-sm text-slate-500",children:[t.jsxs("span",{children:[r.length," members selected"]}),t.jsx(S,{type:"button",onClick:T,disabled:r.length===0,children:"Send SMS"})]})]})}),t.jsx(m,{title:"Log outcome",subtitle:"Track PRs, adherence, RPE",children:t.jsxs("form",{className:"grid md:grid-cols-3 gap-3",onSubmit:async e=>{if(e.preventDefault(),r.length===0){n("Select at least one member to log an outcome.");return}try{await l(`/coach/members/${r[0]}/outcomes`,{method:"POST",body:JSON.stringify({title:p,description:x,type:b})}),y("")}catch(s){n(s instanceof Error?s.message:"Failed to log outcome")}},children:[t.jsx("input",{className:"border rounded-lg px-3 py-2",placeholder:"Outcome title",value:p,onChange:e=>w(e.target.value),required:!0}),t.jsx("input",{className:"border rounded-lg px-3 py-2",placeholder:"Notes",value:x,onChange:e=>y(e.target.value)}),t.jsxs("select",{className:"border rounded-lg px-3 py-2",value:b,onChange:e=>E(e.target.value),children:[t.jsx("option",{value:"outcome",children:"Outcome"}),t.jsx("option",{value:"goal",children:"Goal"})]}),t.jsxs("div",{className:"md:col-span-3 flex justify-between items-center text-sm text-slate-500",children:[t.jsx("span",{children:r[0]?`Logging for ${r[0]}`:"Select a member above"}),t.jsx(S,{type:"submit",disabled:r.length===0,children:"Log entry"})]})]})}),f&&t.jsx("div",{className:"text-sm text-red-600",children:f})]})}export{H as default};
