import{c as _,r as x,j as e,e as xt,a as S,i as G,S as pt,f as ht}from"./app-CkmwQ5Pl.js";import{C as Te}from"./Card-huvhWaid.js";import{B as D}from"./Button-BBzaGNvL.js";import{M as ce}from"./Modal-BPU-FC5n.js";import{T as C}from"./TextInput-CcTkSXZv.js";import{S as Y}from"./SelectInput-CyF3PkuI.js";/* empty css            *//**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=_("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=_("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=_("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=_("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=_("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=_("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=_("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function yt({content:i,children:d}){const m=x.useRef(null),[o,f]=x.useState(!1),[b,L]=x.useState({top:0,left:0});return x.useEffect(()=>{function w(){if(!o||!m.current)return;const E=m.current.getBoundingClientRect();L({top:E.top+window.scrollY-8,left:E.left+E.width/2+window.scrollX})}return o&&(w(),window.addEventListener("scroll",w,!0),window.addEventListener("resize",w)),()=>{window.removeEventListener("scroll",w,!0),window.removeEventListener("resize",w)}},[o]),i?e.jsxs("span",{ref:m,className:"inline-flex",onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:[d,o&&xt.createPortal(e.jsx("div",{className:"pointer-events-none absolute z-50 rounded-lg border border-slate-200 bg-white px-3 py-2 text-[11px] text-slate-700 shadow-2xl",style:{position:"absolute",top:b.top,left:b.left,transform:"translate(-50%, -100%)"},children:i}),document.body)]}):e.jsx("span",{children:d})}function Nt(){return Math.random().toString(36).slice(2,9)}function O(i="",d={}){return{id:Nt(),type:i,data:d}}function Me(i,d){return i==="reps"?{reps:d}:i==="calories"?{calories:d}:i==="meters"?{meters:d}:i==="weight"&&Array.isArray(d)?{setRows:d}:{value:d}}function ze(i,d){const m=d.measurementType??d.measurement_type??"";return i.map(o=>o&&typeof o=="object"&&"type"in o?{type:o.type??m??"",data:o.data??{}}:o&&typeof o=="object"?{type:m??"",data:o}:{type:m??"",data:Me(m??"",o)}).filter(o=>o.type||Object.keys(o.data).length>0)}function pe(i){const d=i.measurements??i.measurement??null;let m=[];const o=i.measurementType??i.measurement_type??"";return Array.isArray(d)?m=ze(d,i):(o||d)&&(m=[{type:o??"",data:d&&typeof d=="object"?d??{}:Me(o??"",d)}]),m}function _e(i){const d=pe(i);return d.length===0?[O()]:d.map(m=>O(m.type,m.data))}function me(i){const d=i.measurements;return Array.isArray(d)?ze(d,i):pe(i)}function wt(i){return i.map(d=>({type:d.type.trim(),data:vt(d)})).filter(d=>d.type.length>0)}function vt(i){return i.type==="weight"?{setRows:Re(i.data)}:i.data??{}}function X(i){const d=Array.isArray(i==null?void 0:i.setRows)?i.setRows:[{set:i==null?void 0:i.set,reps:i==null?void 0:i.reps,load:i==null?void 0:i.load}];return(d.length?d:[{set:1,reps:null,load:""}]).map((o,f)=>({set:Number((o==null?void 0:o.set)??f+1),reps:(o==null?void 0:o.reps)===null||(o==null?void 0:o.reps)===void 0?null:Number(o==null?void 0:o.reps),load:typeof(o==null?void 0:o.load)=="string"?o.load:o!=null&&o.load?String(o.load):""}))}function Re(i){return X(i).map((m,o)=>({set:o+1,reps:typeof m.reps=="number"?m.reps:m.reps??null,load:m.load??""}))}function kt(i){const d=i.type,m=i.data??{};if(d==="weight"){const o=X(m),f=o.slice(0,2).map(b=>`Set ${b.set}: ${b.reps??"—"} reps @ ${b.load&&b.load!==""?b.load:"—"}`);return o.length>2&&f.push(`+${o.length-2} more set${o.length-2===1?"":"s"}`),f}return d==="calories"?[`Calories: ${m.calories??null??"—"}`]:d==="meters"?[`Distance: ${m.meters??null??"—"} m`]:d==="reps"?[`Reps: ${m.reps??null??"—"}`]:d==="weight_load"&&(m!=null&&m.summary)?[String(m.summary)]:Object.keys(m||{}).length?[Object.entries(m).map(([o,f])=>`${o}: ${f}`).join(" · ")]:[]}function St(i){const d=pe(i);return d.length?d.flatMap((m,o)=>{const f=kt(m);return d.length>1?[`Phase ${o+1}: ${m.type||"—"}`,...f]:f}):[]}function Ct(i){const d=i.getFullYear(),m=String(i.getMonth()+1).padStart(2,"0"),o=String(i.getDate()).padStart(2,"0");return`${d}-${m}-${o}`}function xe(i=new Date,d="Mon"){const m=new Date(i),o=m.getDay(),f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].indexOf(d),b=(o-f+7)%7;return m.setDate(m.getDate()-b),m.setHours(0,0,0,0),Ct(m)}function It(){var De;const i=x.useRef(null),d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],m={warmup:"linear-gradient(90deg,#fef3c7,#fde68a)",strength:"linear-gradient(90deg,#4b8ff7,#74b2fb)",metcon:"linear-gradient(90deg,#a5f3fc,#67e8f9)",skill:"linear-gradient(90deg,#22c55e,#16a34a)",cooldown:"linear-gradient(90deg,#ede9fe,#ddd6fe)",other:"linear-gradient(90deg,#e2e8f0,#f1f5f9)"},o=[{value:"warmup",label:"Warm-up"},{value:"strength",label:"Strength"},{value:"metcon",label:"Metcon"},{value:"skill",label:"Skill Work"},{value:"cooldown",label:"Cool-down"},{value:"other",label:"Other"}],f=[{value:"calories",label:"Calories"},{value:"meters",label:"Meters / distance"},{value:"reps",label:"Reps"},{value:"weight",label:"Weight / load"}],[b,L]=x.useState([]),[w,E]=x.useState(null),[F,Oe]=x.useState({startOfWeek:"Mon"}),[M,he]=x.useState(()=>xe(new Date,"Mon")),[B,I]=x.useState([]),[Ie,fe]=x.useState(!0),[ge,j]=x.useState(null),[W,Q]=x.useState(null),[We,P]=x.useState(null),[Z,K]=x.useState(null),[U,A]=x.useState(null),[$t,ee]=x.useState(null),[h,g]=x.useState({title:"",block:"Workout",instructions:"",coachNotes:"",athleteNotes:"",exerciseId:"",exerciseType:"strength",measurements:[O()],restSeconds:"",isScored:!1}),[y,z]=x.useState({}),[V,be]=x.useState(!1),[je,H]=x.useState(!1),[te,se]=x.useState({name:"",description:""}),[Pe,Ae]=x.useState(0),[ne,J]=x.useState(!1),[ye,Le]=x.useState([]),[Ne,re]=x.useState([]),[ae,Fe]=x.useState(""),[we,Be]=x.useState({}),[ve,Ue]=x.useState({}),[ke,Ve]=x.useState({}),[Et,Se]=x.useState(!1),He=h.title||"Workout",Je=m[h.exerciseType??"other"]??m.other??"var(--brand-accent)",qe=((De=o.find(s=>s.value===h.exerciseType))==null?void 0:De.label)??"Workout";x.useEffect(()=>{const s=new AbortController;async function t(){try{const n=await S("/workouts/programs",{signal:s.signal});if(s.signal.aborted)return;L(n.data),!w&&n.data.length>0&&E(n.data[0].id)}catch(n){if(G(n))return;j(n instanceof Error?n.message:"Failed to load programs")}}return t(),()=>s.abort()},[]),x.useEffect(()=>{const s=new AbortController;async function t(){try{const n=await S("/workouts/exercises",{signal:s.signal});if(s.signal.aborted)return;Le(n.data),re(n.data)}catch(n){if(G(n))return;j(n instanceof Error?n.message:"Failed to load exercises")}}return t(),()=>s.abort()},[]),x.useEffect(()=>{const s=ae.trim();if(s.length<2){re(ye);return}const t=new AbortController,n=window.setTimeout(async()=>{try{Se(!0);const a=await S(`/workouts/exercises?search=${encodeURIComponent(s)}`,{signal:t.signal});if(t.signal.aborted)return;re(a.data)}catch(a){if(G(a)||t.signal.aborted)return;j(a instanceof Error?a.message:"Failed to search exercises")}finally{t.signal.aborted||Se(!1)}},250);return()=>{t.abort(),window.clearTimeout(n)}},[ae,ye]),x.useEffect(()=>{if(!w)return;const s=new AbortController;async function t(){try{fe(!0);const n=await S(`/workouts/programs/${w}/calendar?start_date=${M}`,{signal:s.signal});if(s.signal.aborted)return;const a=n.data.days.map(l=>({sessionId:l.session_id??l.sessionId,date:l.date,label:l.label,cards:(l.cards??[]).map(r=>{const c=me(r),u=c[0]??null;return{id:r.id,title:r.title,block:r.block,description:r.description??r.instructions??"",instructions:r.instructions??r.description??"",exerciseId:r.exercise_id??r.exerciseId??null,exerciseType:r.exercise_type??r.exerciseType??null,measurementType:r.measurement_type??(u==null?void 0:u.type)??r.measurementType??null,measurement:(u==null?void 0:u.data)??r.measurement??r.measurement??null,measurements:c,restSeconds:r.rest_seconds??r.restSeconds??null,isScored:!!(r.is_scored??r.isScored??!1),coachNotes:r.coach_notes??r.coachNotes??"",athleteNotes:r.athlete_notes??r.athleteNotes??"",color:r.color}})}));I(a),j(null)}catch(n){if(G(n)||s.signal.aborted)return;j(n instanceof Error?n.message:"Failed to load workouts")}finally{s.signal.aborted||fe(!1)}}return t(),()=>s.abort()},[w,M,Pe]);const Ge=x.useMemo(()=>{const s=new Map;return B.forEach((t,n)=>{t.cards.forEach((a,l)=>s.set(a.id,{dayIndex:n,cardIndex:l}))}),s},[B]);async function Ye(s){s.preventDefault();try{const t=await S("/workouts/programs",{method:"POST",body:JSON.stringify(te)});L(n=>[...n,t.data]),E(t.data.id),H(!1),se({name:"",description:""})}catch(t){j(t instanceof Error?t.message:"Unable to create program")}}async function Xe(s){var t;try{const a=(await S(`/workouts/sessions/${s}/items`,{method:"POST",body:JSON.stringify({title:"New workout",block:"Accessory",exercise_type:"strength",instructions:"Describe goals, load, and cues."})})).data,l=me(a),r=l[0]??null,c={id:a.id,title:a.title,block:a.block,description:a.instructions??a.description??"",instructions:a.instructions??a.description??"",exerciseId:a.exercise_id??null,exerciseType:a.exercise_type??"strength",measurementType:a.measurement_type??(r==null?void 0:r.type)??"",measurement:(r==null?void 0:r.data)??a.measurement??{},measurements:l,restSeconds:a.rest_seconds??null,isScored:!!(a.is_scored??!1),coachNotes:a.coach_notes??"",athleteNotes:a.athlete_notes??"",color:a.color??null};I(u=>u.map(p=>p.sessionId===s?{...p,cards:[...p.cards,c]}:p)),A(c),ee(s),g({title:c.title,block:c.block,instructions:c.instructions??"",coachNotes:c.coachNotes??"",athleteNotes:c.athleteNotes??"",exerciseId:c.exerciseId??"",exerciseType:c.exerciseType??"strength",measurements:_e(c),restSeconds:((t=c.restSeconds)==null?void 0:t.toString())??"",isScored:c.isScored??!1}),z({})}catch(n){j(n instanceof Error?n.message:"Failed to create workout")}}function q(){Ae(s=>s+1)}async function Qe(s){I(t=>t.map(n=>({...n,cards:n.cards.filter(a=>a.id!==s)})));try{await S(`/workouts/items/${s}`,{method:"DELETE"})}catch(t){j(t instanceof Error?t.message:"Unable to delete card"),q()}}async function Ze(s){try{await S(`/workouts/items/${s}/duplicate`,{method:"POST"}),q()}catch(t){j(t instanceof Error?t.message:"Unable to duplicate")}}async function Ke(s,t,n){const a=Ge.get(s);if(a){I(l=>{const r=l.map(v=>({...v,cards:[...v.cards]})),{dayIndex:c,cardIndex:u}=a,[p]=r[c].cards.splice(u,1),N=r.find(v=>v.sessionId===t);if(!N)return l;const $=n??N.cards.length;return N.cards.splice($,0,p),r});try{await S(`/workouts/items/${s}/move`,{method:"POST",body:JSON.stringify({session_id:t,position:n??null})})}catch(l){j(l instanceof Error?l.message:"Unable to move card"),q()}}}function Ce(s,t){if(!W)return;const n=B.find(l=>l.sessionId===s);if(!n)return;const a=t?n.cards.findIndex(l=>l.id===t):n.cards.length;Ke(W,s,a<0?void 0:a),Q(null)}async function et(s){var t,n;if(s.preventDefault(),!!U)try{be(!0);const a=wt(h.measurements),l=a[0]??null,c=(await S(`/workouts/items/${U.id}`,{method:"PUT",body:JSON.stringify({title:h.title,block:h.block,instructions:h.instructions,coach_notes:h.coachNotes,athlete_notes:h.athleteNotes,exercise_id:h.exerciseId||null,exercise_type:h.exerciseType,measurement_type:(l==null?void 0:l.type)??null,measurement:(l==null?void 0:l.data)??null,measurements:a,rest_seconds:h.restSeconds?Number(h.restSeconds):null,is_scored:h.isScored})})).data,u=me(c),p=c.measurement_type??((t=u==null?void 0:u[0])==null?void 0:t.type)??null,N=c.measurement??((n=u==null?void 0:u[0])==null?void 0:n.data)??null;I($=>$.map(v=>({...v,cards:v.cards.map(k=>k.id===U.id?{...k,title:c.title,block:c.block,description:c.instructions??c.description??"",instructions:c.instructions??c.description??"",exerciseId:c.exercise_id??k.exerciseId??null,exerciseType:c.exercise_type??k.exerciseType??null,measurementType:p??k.measurementType??null,measurement:N??k.measurement??null,measurements:u,restSeconds:c.rest_seconds??k.restSeconds??null,isScored:!!(c.is_scored??k.isScored??!1),coachNotes:c.coach_notes??k.coachNotes??"",athleteNotes:c.athlete_notes??k.athleteNotes??""}:k)}))),q(),z({}),A(null),ee(null)}catch(a){if(a instanceof Error){try{const l=JSON.parse(a.message);if(l!=null&&l.errors){z(l.errors);return}}catch{}j(a.message||"Unable to save workout")}else j("Unable to save workout")}finally{be(!1)}}function tt(){const s=new Date(`${M}T00:00:00`),t=new Date(s);return t.setDate(s.getDate()+6),`${s.toLocaleDateString(void 0,{month:"short",day:"numeric"})} – ${t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}`}x.useEffect(()=>{if(!ne)return;function s(t){i.current&&(i.current.contains(t.target)||J(!1))}return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[ne]),x.useEffect(()=>{he(s=>xe(new Date(`${s}T00:00:00`),F.startOfWeek))},[F.startOfWeek]);function $e(s){const t=new Date(`${M}T00:00:00`);t.setDate(t.getDate()+s*7),he(xe(t,F.startOfWeek))}function st(){console.info("Clone week triggered for",M)}function nt(){console.info("Delete week triggered for",M)}function R(s){z(t=>{if(!t[s])return t;const{[s]:n,...a}=t;return a})}function rt(s){g(t=>{const n=[...t.measurements],a=O();return typeof s=="number"?n.splice(s,0,a):n.push(a),{...t,measurements:n}})}function at(s){g(t=>{if(t.measurements.length<=1)return t;const n=t.measurements.filter((a,l)=>l!==s);return{...t,measurements:n}})}function lt(s,t){g(n=>{const a=n.measurements.map((l,r)=>r===s?{...l,type:t,data:t==="weight"?{setRows:Re({})}:{}}:l);return{...n,measurements:a}}),R(`measurements.${s}.type`)}function le(s,t,n){g(a=>{const l=a.measurements.map((r,c)=>{if(c!==s)return r;const u={...r.data};return it(u,t,n),{...r,data:u}});return{...a,measurements:l}}),R(`measurements.${s}.${t}`)}function oe(s,t){g(n=>{const a=n.measurements.map((l,r)=>{if(r!==s)return l;const c=t(X(l.data));return{...l,data:{...l.data,setRows:c}}});return{...n,measurements:a}})}function ot(s,t){oe(s,n=>{const a=[...n],l=typeof t=="number"?t:n.length;return a.splice(l,0,{set:l+1,reps:null,load:""}),a.map((r,c)=>({...r,set:c+1}))})}function it(s,t,n){const a=t.split("."),l=a.pop();let r=s;for(const u of a)if(/^\d+$/.test(u)){const N=Number(u);if(!Array.isArray(r))return;r[N]||(r[N]={}),r=r[N]}else(!(u in r)||r[u]===null)&&(r[u]={}),r=r[u];if(l===void 0)return;if(/^\d+$/.test(l)){const u=Number(l);if(!Array.isArray(r))return;r[u]=n}else r[l]=n}function ct(s,t){oe(s,n=>n.length<=1?n:n.filter((l,r)=>r!==t).map((l,r)=>({...l,set:r+1})))}function Ee(s,t,n,a){oe(s,l=>l.map((r,c)=>c===t?{...r,[n]:n==="load"?String(a??""):n==="reps"?a===null||a===""?null:Number(a):Number(a??r.set)}:r)),R(`measurements.${s}.setRows.${t}.${n}`)}const ie=s=>{const t=(s??"").normalize("NFKC").replace(/\s+/g," ").trim().toLowerCase();return t===""||t==="n/a"?"other":["warmup","warm-up","warm up"].includes(t)?"warmup":["cooldown","cool-down","cool down"].includes(t)?"cooldown":["metcon","met-con","conditioning"].includes(t)?"metcon":["skill","skill work","skills"].includes(t)?"skill":["strength","lift"].includes(t)?"strength":t},dt=x.useMemo(()=>{const s={};return(Ne??[]).forEach(t=>{var r;const n=ie(t.type);s[n]||(s[n]={label:((r=o.find(c=>c.value===n))==null?void 0:r.label)??"Other",categories:{}});const a=t.category??"General";s[n].categories[a]||(s[n].categories[a]={label:a,modalities:{}});const l=t.modality??"General";s[n].categories[a].modalities[l]||(s[n].categories[a].modalities[l]={label:l,items:[]}),s[n].categories[a].modalities[l].items.push(t)}),s},[Ne,o]);function ut(s){const t=ie(s.type),n=(s.modality??"").toLowerCase(),a=s.name.toLowerCase();return t==="cooldown"||t==="warmup"?{type:"meters",data:{meters:100}}:t==="metcon"?n.includes("erg")||n.includes("bike")||n.includes("run")||a.includes("row")?{type:"meters",data:{meters:400}}:a.includes("calorie")||n.includes("bike")?{type:"calories",data:{calories:20}}:{type:"reps",data:{reps:15}}:t==="skill"?{type:"reps",data:{reps:5}}:n.includes("barbell")||n.includes("dumbbell")||n.includes("kettlebell")?{type:"weight",data:{weight:95,unit:"lb"}}:{type:"reps",data:{reps:8}}}const mt=e.jsxs("div",{className:"flex items-center gap-3",ref:i,children:[ge&&e.jsx("p",{className:"text-sm text-rose-600",children:ge}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-slate-200 text-slate-600 hover:bg-slate-50",title:"Preferences",onClick:()=>J(s=>!s),children:e.jsx(pt,{size:18})}),ne&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 rounded-2xl border border-slate-100 bg-white p-4 text-sm shadow-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Start week on"}),e.jsx(Y,{className:"mt-1",value:F.startOfWeek,onChange:s=>Oe(t=>({...t,startOfWeek:s.target.value})),children:d.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsx("div",{className:"my-3 border-t border-slate-100"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{type:"button",className:"rounded-xl border border-slate-200 px-3 py-2 text-left font-semibold text-slate-700 hover:bg-slate-50",onClick:()=>{J(!1),st()},children:"Clone this week"}),e.jsx("button",{type:"button",className:"rounded-xl border border-rose-200 px-3 py-2 text-left font-semibold text-rose-600 hover:bg-rose-50",onClick:()=>{J(!1),nt()},children:"Delete this week"})]})]})]})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Te,{title:"Workout builder",subtitle:"Drag workouts between days and manage programs",right:mt,children:e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Program"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{value:w??"",onChange:s=>E(s.target.value),className:"w-auto rounded-lg",children:b.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))}),e.jsx("button",{type:"button",onClick:()=>H(!0),className:"inline-flex h-10 w-10 items-center justify-center rounded-full border border-slate-200 text-slate-600",title:"Create program",children:e.jsx(T,{size:16})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Week"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{type:"button",onClick:()=>$e(-1),children:"Prev"}),e.jsx("span",{className:"font-semibold text-slate-700",children:tt()}),e.jsx(D,{type:"button",onClick:()=>$e(1),children:"Next"})]})]})]})}),Ie?e.jsx(Te,{title:"Loading week",children:e.jsx("p",{className:"text-sm text-slate-500",children:"Fetching workouts…"})}):e.jsx("div",{className:"grid gap-4 lg:grid-cols-7",children:B.map(s=>e.jsxs("div",{className:"rounded-3xl border border-slate-100 bg-slate-50 shadow-inner",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-white/70 bg-white/60 px-4 py-3",children:[e.jsxs("div",{children:[(()=>{const t=new Date(`${s.date}T00:00:00`);return e.jsx("p",{className:"text-sm font-semibold text-slate-900",children:t.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})})})(),e.jsx("p",{className:"text-xs text-slate-500",children:s.label||"—"})]}),e.jsx("button",{type:"button",className:"rounded-full border border-slate-200 p-2 text-white shadow-lg focus:outline-none focus:ring-2 focus:ring-brand-200 hover:-translate-y-0.5",style:{backgroundImage:"linear-gradient(90deg, var(--brand-primary), var(--brand-accent))"},onClick:()=>Xe(s.sessionId),children:e.jsx(T,{size:16})})]}),e.jsx("div",{className:"flex min-h-[420px] flex-col gap-3 overflow-y-auto px-3 py-4",onDragOver:t=>t.preventDefault(),onDrop:t=>{t.preventDefault(),Ce(s.sessionId)},children:s.cards.map(t=>{const n=ie(t.exerciseType),a=m[n]??m.other,l=St(t),r=[];t.isScored&&r.push({label:"Scored",tone:"primary"}),t.restSeconds&&r.push({label:`Rest ${t.restSeconds}s`,tone:"neutral"}),t.athleteNotes&&r.push({label:"Athlete note",tone:"note",note:t.athleteNotes}),t.coachNotes&&r.push({label:"Coach note",tone:"warn",note:t.coachNotes});const c=t.instructions??t.description??"";return e.jsxs("article",{draggable:!0,onDragStart:u=>{if(We!==t.id){u.preventDefault();return}Q(t.id)},onDragEnd:()=>{Q(null),P(null)},onDragOver:u=>u.preventDefault(),onDrop:u=>{u.preventDefault(),Ce(s.sessionId,t.id)},className:`rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden ${W===t.id?"opacity-50":""}`,children:[e.jsxs("div",{className:"flex items-center gap-2 pl-2 pr-4 py-1.5 text-white cursor-grab active:cursor-grabbing select-none",style:{background:a},role:"button",tabIndex:0,onMouseDown:()=>P(t.id),onMouseUp:()=>{W||P(null)},onMouseLeave:()=>{W||P(null)},onTouchStart:()=>P(t.id),children:[e.jsx(bt,{className:"h-4 w-4 -ml-1 text-white/80"}),e.jsx("p",{className:"text-base font-semibold leading-tight",children:t.title})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[c&&e.jsx("p",{className:"text-sm text-slate-600",children:c}),l.length>0&&e.jsx("ul",{className:"space-y-1 text-xs text-slate-500",children:l.map((u,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"mt-0.5 h-1.5 w-1.5 rounded-full bg-slate-300"}),e.jsx("span",{children:u})]},`${t.id}-summary-${p}`))}),r.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:r.map((u,p)=>e.jsx(yt,{content:u.note,children:e.jsx("span",{className:`rounded-full px-2 py-1 text-[10px] font-semibold ${u.tone==="primary"?"bg-emerald-50 text-emerald-700":u.tone==="note"?"bg-sky-50 text-sky-700":u.tone==="warn"?"bg-amber-50 text-amber-700":"bg-slate-100 text-slate-600"}`,children:u.label})},`${t.id}-chip-${p}`))}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 pt-1",children:[e.jsx("button",{type:"button",onClick:()=>Qe(t.id),title:"Delete",className:"hover:text-rose-500",children:e.jsx(ue,{size:16})}),e.jsx("button",{type:"button",onClick:()=>Ze(t.id),title:"Duplicate",className:"hover:text-slate-700",children:e.jsx(ft,{size:16})}),e.jsx("button",{type:"button",onClick:()=>K(t),title:"Preview",className:"hover:text-slate-700",children:e.jsx(gt,{size:16})}),e.jsx("button",{type:"button",onClick:()=>{var u;A(t),ee(s.sessionId),g({title:t.title,block:t.block,instructions:t.instructions??t.description??"",coachNotes:t.coachNotes??"",athleteNotes:t.athleteNotes??"",exerciseId:t.exerciseId??"",exerciseType:t.exerciseType??"strength",measurements:t.measurements&&t.measurements.length?t.measurements.map(p=>O(p.type??"",p.data??{})):_e(t),restSeconds:((u=t.restSeconds)==null?void 0:u.toString())??"",isScored:t.isScored??!1}),z({})},title:"Edit",className:"hover:text-slate-700",children:e.jsx(jt,{size:16})})]})]})]},t.id)})})]},s.sessionId))}),Z&&e.jsx(ce,{open:!0,onClose:()=>K(null),title:Z.title,children:e.jsxs("div",{className:"space-y-4 text-sm text-slate-700",children:[e.jsxs("section",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-amber-600",children:"Workout Definition"}),e.jsx("p",{className:"mt-1 text-slate-800",children:Z.description})]}),e.jsxs("section",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-sky-600",children:"Athlete Notes"}),e.jsx("p",{className:"mt-1 text-slate-800",children:"Focus on tempo and bracing. Keep ribs stacked and drive vertically."})]}),e.jsxs("section",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-500",children:"Coach Notes"}),e.jsx("p",{className:"mt-1 text-slate-500",children:"Use RPE 8.5 cap; scale to DB presses if shoulder issues appear."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(D,{type:"button",onClick:()=>K(null),children:"Close"})})]})}),U&&e.jsx(ce,{open:!0,onClose:()=>!V&&A(null),title:He,subtitle:qe,headerStyle:{background:Je},headerClassName:"border-transparent",children:e.jsxs("form",{className:"space-y-6",onSubmit:et,children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Title",e.jsx(C,{className:"mt-1",value:h.title,onChange:s=>{g(t=>({...t,title:s.target.value})),R("title")},required:!0}),y.title&&e.jsx("p",{className:"mt-1 text-xs text-rose-600",children:y.title[0]})]}),e.jsxs("div",{className:"flex flex-col justify-end",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Scoring"}),e.jsxs("div",{className:"mt-1 flex items-center gap-3",children:[e.jsx("button",{type:"button",className:`rounded-full px-3 py-2 text-sm font-semibold ${h.isScored?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600"}`,onClick:()=>g(s=>({...s,isScored:!s.isScored})),children:h.isScored?"Scored":"Unscored"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Scored workouts can be shared to leaderboards."})]})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Exercise type",e.jsx(Y,{className:"mt-1",value:h.exerciseType,onChange:s=>{g(t=>({...t,exerciseType:s.target.value})),R("exercise_type")},children:o.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),y.exercise_type&&e.jsx("p",{className:"mt-1 text-xs text-rose-600",children:y.exercise_type[0]})]})}),e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Workout instructions",e.jsx("textarea",{className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2",rows:3,placeholder:"Describe goals, pacing, and coaching cues",value:h.instructions,onChange:s=>g(t=>({...t,instructions:s.target.value}))})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Rest between sets (seconds)",e.jsx(C,{type:"number",min:0,className:"mt-1",value:h.restSeconds,onChange:s=>g(t=>({...t,restSeconds:s.target.value})),placeholder:"e.g. 60"})]}),e.jsx("div",{className:"text-xs text-slate-500 self-end",children:"Leave blank if the workout block doesn’t have prescribed rest."})]}),e.jsxs("div",{className:"space-y-4",children:[h.measurements.map((s,t)=>e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white/60 p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("label",{className:"flex-1 text-sm font-medium text-slate-700",children:["Measurement type",e.jsxs(Y,{className:"mt-1",value:s.type,onChange:n=>lt(t,n.target.value),children:[e.jsx("option",{value:"",children:"Select"}),f.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))]}),y[`measurements.${t}.type`]&&e.jsx("p",{className:"mt-1 text-xs text-rose-600",children:y[`measurements.${t}.type`][0]})]}),e.jsxs("div",{className:"flex gap-1 pb-1",children:[e.jsx("button",{type:"button",onClick:()=>rt(t+1),className:"rounded-full border border-slate-200 p-2 text-slate-500 hover:bg-slate-100",title:"Add measurement",children:e.jsx(T,{size:14})}),h.measurements.length>1&&e.jsx("button",{type:"button",onClick:()=>at(t),className:"rounded-full border border-slate-200 p-2 text-slate-500 hover:bg-rose-50",title:"Remove measurement",children:e.jsx(ue,{size:14})})]})]}),s.type==="calories"&&e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Calories",e.jsx(C,{type:"number",min:0,className:"mt-1",value:s.data.calories??"",onChange:n=>le(t,"calories",Number(n.target.value))})]}),s.type==="meters"&&e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Distance (meters)",e.jsx(C,{type:"number",min:0,className:"mt-1",value:s.data.meters??"",onChange:n=>le(t,"meters",Number(n.target.value))})]}),s.type==="reps"&&e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Reps",e.jsx(C,{type:"number",min:0,className:"mt-1",value:s.data.reps??"",onChange:n=>le(t,"reps",Number(n.target.value))})]}),s.type==="weight"&&(()=>{const n=X(s.data);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-[60px_110px_minmax(0,_1fr)_70px] gap-3 text-xs font-semibold uppercase tracking-wide text-slate-500",children:[e.jsx("span",{children:"Set #"}),e.jsx("span",{children:"Reps"}),e.jsx("span",{children:"Weight / % 1RM"}),e.jsx("span",{className:"text-right",children:"Actions"})]}),n.map((a,l)=>e.jsxs("div",{className:"grid grid-cols-[60px_110px_minmax(0,_1fr)_70px] items-center gap-3",children:[e.jsx("div",{className:"px-3 py-2 text-center font-semibold text-slate-600",children:a.set}),e.jsx(C,{type:"number",min:0,value:a.reps??"",onChange:r=>Ee(t,l,"reps",r.target.value)}),e.jsx(C,{placeholder:"e.g. 95 or 75%",value:a.load??"",onChange:r=>Ee(t,l,"load",r.target.value)}),e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[l===n.length-1&&e.jsx("button",{type:"button",onClick:()=>ot(t,l+1),className:"inline-flex h-9 w-9 items-center justify-center rounded-full border border-slate-200 text-slate-500 hover:bg-slate-100",title:"Add set",children:e.jsx(T,{size:14})}),n.length>1&&e.jsx("button",{type:"button",onClick:()=>ct(t,l),className:"inline-flex h-9 w-9 items-center justify-center rounded-full border border-slate-200 text-slate-500 hover:bg-rose-50",title:"Remove set",children:e.jsx(ue,{size:14})})]})]},`${s.id}-set-${l}`))]})})()]},s.id)),y.measurement_type&&e.jsx("p",{className:"text-xs text-rose-600",children:y.measurement_type[0]}),y.measurement&&e.jsx("p",{className:"text-xs text-rose-600",children:y.measurement[0]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Athlete notes",e.jsx("textarea",{className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2",rows:3,value:h.athleteNotes,onChange:s=>g(t=>({...t,athleteNotes:s.target.value}))})]}),e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Coach notes",e.jsx("textarea",{className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2",rows:3,value:h.coachNotes,onChange:s=>g(t=>({...t,coachNotes:s.target.value}))})]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"rounded-full bg-white p-2 text-slate-500",children:e.jsx(ht,{size:16})}),e.jsx(C,{className:"flex-1",placeholder:"Search exercises (Bench Press, Back Squat, custom…) ",value:ae,onChange:s=>Fe(s.target.value)})]}),y.exercise_id&&e.jsx("p",{className:"mt-2 text-xs text-rose-600",children:y.exercise_id[0]}),e.jsx("div",{className:"mt-3 max-h-64 overflow-y-auto rounded-xl border border-slate-200 bg-white",children:Object.entries(dt).map(([s,t],n,a)=>e.jsxs("div",{className:n<a.length-1?"border-b border-slate-100":"",children:[e.jsxs("button",{type:"button",className:"flex w-full items-center justify-between px-3 py-2 text-left text-sm font-semibold text-slate-800",onClick:()=>Be(l=>({...l,[s]:l[s]===!1})),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[we[s]!==!1?e.jsx(de,{size:14}):e.jsx(T,{size:14}),t.label]}),e.jsxs("span",{className:"text-xs text-slate-400",children:[Object.keys(t.categories).length," categories"]})]}),we[s]!==!1&&e.jsx("div",{className:"border-t border-slate-100 pl-4",children:Object.entries(t.categories).map(([l,r])=>e.jsxs("div",{className:"border-b border-slate-50 last:border-b-0",children:[e.jsxs("button",{type:"button",className:"flex w-full items-center justify-between px-3 py-2 text-left text-sm font-semibold text-slate-700",onClick:()=>Ue(c=>({...c,[`${s}::${l}`]:c[`${s}::${l}`]===!1})),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[ve[`${s}::${l}`]!==!1?e.jsx(de,{size:12}):e.jsx(T,{size:12}),e.jsx("span",{className:"text-xs uppercase tracking-wide text-slate-500",children:r.label})]}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:[Object.keys(r.modalities).length," modalities"]})]}),ve[`${s}::${l}`]!==!1&&e.jsx("div",{className:"border-t border-slate-100 pl-4",children:Object.entries(r.modalities).map(([c,u])=>e.jsxs("div",{className:"border-b border-slate-50 last:border-b-0",children:[e.jsxs("button",{type:"button",className:"flex w-full items-center justify-between px-3 py-2 text-left text-sm font-semibold text-slate-600",onClick:()=>Ve(p=>({...p,[`${s}::${l}::${c}`]:p[`${s}::${l}::${c}`]===!1})),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[ke[`${s}::${l}::${c}`]!==!1?e.jsx(de,{size:12}):e.jsx(T,{size:12}),e.jsx("span",{className:"text-[11px] uppercase tracking-wide text-slate-500",children:u.label})]}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:[u.items.length," exercises"]})]}),ke[`${s}::${l}::${c}`]!==!1&&e.jsx("div",{className:"grid gap-1 px-3 pb-3 pl-4",children:u.items.map(p=>e.jsxs("button",{type:"button",className:`flex items-center justify-between rounded-lg border px-3 py-2 text-sm ${h.exerciseId===p.id?"border-brand-300 bg-brand-50 text-brand-700":"border-slate-200 text-slate-700 hover:bg-slate-50"}`,onClick:()=>{const N=ut(p);g($=>{const v=$.measurements.length?[...$.measurements]:[O()];return v[0]={...v[0],type:N.type,data:N.data},{...$,exerciseId:p.id,title:p.name,exerciseType:p.type??$.exerciseType,measurements:v}}),R("exercise_id")},children:[e.jsx("span",{children:p.name}),e.jsx("span",{className:"text-[10px] uppercase text-slate-400",children:p.modality||(p.is_public?"Std":"Custom")})]},p.id))})]},c))})]},l))})]},s))})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(D,{type:"button",onClick:()=>{A(null),z({})},disabled:V,children:"Cancel"}),e.jsx(D,{type:"submit",disabled:V,className:"bg-slate-900 text-white hover:bg-slate-800",children:V?"Saving…":"Save workout"})]})]})}),je&&e.jsx(ce,{open:je,onClose:()=>H(!1),title:"Create program",children:e.jsxs("form",{className:"space-y-4",onSubmit:Ye,children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Name",e.jsx(C,{className:"mt-1",value:te.name,onChange:s=>se(t=>({...t,name:s.target.value})),required:!0})]}),e.jsxs("label",{className:"block text-sm font-medium text-slate-700",children:["Description",e.jsx("textarea",{className:"mt-1 w-full rounded-xl border border-slate-200 px-3 py-2",rows:3,value:te.description,onChange:s=>se(t=>({...t,description:s.target.value}))})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(D,{type:"button",onClick:()=>H(!1),children:"Cancel"}),e.jsx(D,{type:"submit",className:"bg-slate-900 text-white hover:bg-slate-800",children:"Create program"})]})]})})]})}export{It as default};
